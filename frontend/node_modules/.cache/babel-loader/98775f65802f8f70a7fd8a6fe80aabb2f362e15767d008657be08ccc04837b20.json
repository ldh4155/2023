{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useDispatch } from \"react-redux\";\nimport { api } from \"./api\";\nimport { LogOut } from '../../redux/Action/LoginAction';\nexport const refreshAccessToken = async () => {\n  _s();\n  const dispatch = useDispatch();\n  try {\n    const response = await api.post(`reissue`, {}, {\n      withCredentials: true\n    });\n    const accessToken = response.headers[\"access\"];\n    console.log(\"access\", accessToken);\n    if (!accessToken) {\n      throw new Error(\"Access token이 없습니다.\");\n    }\n    localStorage.setItem(\"access\", accessToken);\n  } catch (error) {\n    console.log(\"재발급 실패\");\n    localStorage.removeItem('access');\n    console.error(error.response ? error.response.status : error.message);\n    try {\n      await api.post(`signout`, {}, {\n        withCredentials: true\n      });\n      dispatch(LogOut());\n    } catch (signoutError) {\n      console.error(\"로그아웃 실패\", signoutError);\n    }\n\n    // Custom event 발생\n    window.dispatchEvent(new CustomEvent(\"unauthorized\"));\n    throw error; // 중요한 부분: 오류를 던져서 상위에서 처리하게 함\n  }\n};\n_s(refreshAccessToken, \"rgTLoBID190wEKCp9+G8W6F7A5M=\", false, function () {\n  return [useDispatch];\n});","map":{"version":3,"names":["useDispatch","api","LogOut","refreshAccessToken","_s","dispatch","response","post","withCredentials","accessToken","headers","console","log","Error","localStorage","setItem","error","removeItem","status","message","signoutError","window","dispatchEvent","CustomEvent"],"sources":["C:/Users/user/2023TeamProject/graduate/frontend/src/api/reissue.js"],"sourcesContent":["import { useDispatch } from \"react-redux\";\r\nimport { api } from \"./api\";\r\nimport { LogOut } from '../../redux/Action/LoginAction'\r\nexport const refreshAccessToken = async () => {\r\n  const dispatch = useDispatch();\r\n  try {\r\n    const response = await api.post(`reissue`, {}, { withCredentials: true }); \r\n    const accessToken = response.headers[\"access\"];\r\n    console.log(\"access\", accessToken);\r\n    if (!accessToken) {\r\n      throw new Error(\"Access token이 없습니다.\");\r\n    }\r\n    localStorage.setItem(\"access\", accessToken);\r\n  } catch (error) {\r\n    console.log(\"재발급 실패\")\r\n    localStorage.removeItem('access');\r\n    console.error(error.response ? error.response.status : error.message);\r\n    try {\r\n      await api.post(`signout`, {}, { withCredentials: true });\r\n      dispatch(LogOut());\r\n    } catch (signoutError) {\r\n      console.error(\"로그아웃 실패\", signoutError);\r\n    }\r\n\r\n    // Custom event 발생\r\n    window.dispatchEvent(new CustomEvent(\"unauthorized\"));\r\n    throw error; // 중요한 부분: 오류를 던져서 상위에서 처리하게 함\r\n  }\r\n};"],"mappings":";AAAA,SAASA,WAAW,QAAQ,aAAa;AACzC,SAASC,GAAG,QAAQ,OAAO;AAC3B,SAASC,MAAM,QAAQ,gCAAgC;AACvD,OAAO,MAAMC,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EAAAC,EAAA;EAC5C,MAAMC,QAAQ,GAAGL,WAAW,CAAC,CAAC;EAC9B,IAAI;IACF,MAAMM,QAAQ,GAAG,MAAML,GAAG,CAACM,IAAI,CAAE,SAAQ,EAAE,CAAC,CAAC,EAAE;MAAEC,eAAe,EAAE;IAAK,CAAC,CAAC;IACzE,MAAMC,WAAW,GAAGH,QAAQ,CAACI,OAAO,CAAC,QAAQ,CAAC;IAC9CC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEH,WAAW,CAAC;IAClC,IAAI,CAACA,WAAW,EAAE;MAChB,MAAM,IAAII,KAAK,CAAC,qBAAqB,CAAC;IACxC;IACAC,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEN,WAAW,CAAC;EAC7C,CAAC,CAAC,OAAOO,KAAK,EAAE;IACdL,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IACrBE,YAAY,CAACG,UAAU,CAAC,QAAQ,CAAC;IACjCN,OAAO,CAACK,KAAK,CAACA,KAAK,CAACV,QAAQ,GAAGU,KAAK,CAACV,QAAQ,CAACY,MAAM,GAAGF,KAAK,CAACG,OAAO,CAAC;IACrE,IAAI;MACF,MAAMlB,GAAG,CAACM,IAAI,CAAE,SAAQ,EAAE,CAAC,CAAC,EAAE;QAAEC,eAAe,EAAE;MAAK,CAAC,CAAC;MACxDH,QAAQ,CAACH,MAAM,CAAC,CAAC,CAAC;IACpB,CAAC,CAAC,OAAOkB,YAAY,EAAE;MACrBT,OAAO,CAACK,KAAK,CAAC,SAAS,EAAEI,YAAY,CAAC;IACxC;;IAEA;IACAC,MAAM,CAACC,aAAa,CAAC,IAAIC,WAAW,CAAC,cAAc,CAAC,CAAC;IACrD,MAAMP,KAAK,CAAC,CAAC;EACf;AACF,CAAC;AAACZ,EAAA,CAzBWD,kBAAkB;EAAA,QACZH,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}